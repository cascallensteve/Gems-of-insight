<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Functionality Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .test-container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
        .info { background: #d1ecf1; border-color: #bee5eb; }
        button { padding: 10px 15px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .result { margin: 10px 0; padding: 10px; background: #f8f9fa; border-radius: 4px; }
        textarea { width: 100%; height: 100px; margin: 5px 0; }
        input { width: 100%; padding: 8px; margin: 5px 0; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ Blog Functionality Testing</h1>
        
        <div class="test-section info">
            <h3>üìã Test Overview</h3>
            <p>This page tests both client and admin blog functionality:</p>
            <ul>
                <li>‚úÖ Client Blog Page: <a href="http://localhost:54112/blog" target="_blank">localhost:54112/blog</a></li>
                <li>‚úÖ Admin Panel: <a href="http://localhost:54112/admin" target="_blank">localhost:54112/admin</a></li>
                <li>‚úÖ API Endpoints: https://gems-of-truth.vercel.app/blogs/</li>
            </ul>
        </div>

        <div class="test-section success">
            <h3>‚úÖ API Status</h3>
            <p><strong>Base URL:</strong> https://gems-of-truth.vercel.app</p>
            <p><strong>Blog Endpoints:</strong></p>
            <ul>
                <li>GET /blogs/all-blogs ‚úÖ</li>
                <li>GET /blogs/blog-detail/{id}/ ‚úÖ</li>
                <li>POST /blogs/add-blog (requires auth) ‚úÖ</li>
                <li>POST /blogs/edit-blog/{id}/ (requires auth) ‚úÖ</li>
            </ul>
            <div id="api-results"></div>
        </div>

        <div class="test-section">
            <h3>üî¨ Live API Test</h3>
            <button onclick="testGetAllBlogs()">Test Get All Blogs</button>
            <button onclick="testGetBlogDetail()">Test Get Blog Detail</button>
            <div id="live-test-results"></div>
        </div>

        <div class="test-section">
            <h3>üìù Add Blog Test (Requires Authentication)</h3>
            <p>Enter authentication token to test blog creation:</p>
            <input type="text" id="authToken" placeholder="Enter your authentication token here" />
            
            <div style="margin: 10px 0;">
                <input type="text" id="blogTitle" placeholder="Blog Title" value="Test Blog Post" />
                <input type="text" id="blogDescription" placeholder="Blog Description" value="This is a test blog post" />
                <textarea id="blogBody" placeholder="Blog Content">This is the main content of the test blog post.</textarea>
                <input type="text" id="readTime" placeholder="Read Time" value="3 minutes" />
                <input type="text" id="tagList" placeholder="Tags (space separated)" value="Test Health Wellness" />
            </div>
            
            <button onclick="testAddBlog()">Test Add Blog</button>
            <div id="add-blog-results"></div>
        </div>

        <div class="test-section info">
            <h3>üì± Access Instructions</h3>
            <ol>
                <li><strong>Client Blog Page:</strong> Go to <a href="http://localhost:54112/blog" target="_blank">localhost:54112/blog</a></li>
                <li><strong>Admin Panel:</strong> Go to <a href="http://localhost:54112/admin" target="_blank">localhost:54112/admin</a></li>
                <li><strong>Admin Blog Manager:</strong> Login as admin ‚Üí Click "Blog Manager" in sidebar</li>
                <li><strong>Add New Blog:</strong> In admin blog manager ‚Üí Click "Create New Post"</li>
            </ol>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'https://gems-of-truth.vercel.app';

        async function testGetAllBlogs() {
            const resultsDiv = document.getElementById('live-test-results');
            resultsDiv.innerHTML = '<p>Testing GET /blogs/all-blogs...</p>';
            
            try {
                const response = await fetch(`${API_BASE_URL}/blogs/all-blogs`);
                const data = await response.json();
                
                resultsDiv.innerHTML = `
                    <div class="result success">
                        <h4>‚úÖ GET All Blogs Success</h4>
                        <p><strong>Status:</strong> ${response.status}</p>
                        <p><strong>Blogs found:</strong> ${data.blogs ? data.blogs.length : 0}</p>
                        <p><strong>Sample blog:</strong> ${data.blogs && data.blogs[0] ? data.blogs[0].title : 'No blogs found'}</p>
                    </div>
                `;
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="result error">
                        <h4>‚ùå GET All Blogs Failed</h4>
                        <p><strong>Error:</strong> ${error.message}</p>
                    </div>
                `;
            }
        }

        async function testGetBlogDetail() {
            const resultsDiv = document.getElementById('live-test-results');
            resultsDiv.innerHTML = '<p>Testing GET /blogs/blog-detail/1/...</p>';
            
            try {
                const response = await fetch(`${API_BASE_URL}/blogs/blog-detail/1/`);
                const data = await response.json();
                
                resultsDiv.innerHTML = `
                    <div class="result success">
                        <h4>‚úÖ GET Blog Detail Success</h4>
                        <p><strong>Status:</strong> ${response.status}</p>
                        <p><strong>Blog title:</strong> ${data.blog ? data.blog.title : 'No blog found'}</p>
                        <p><strong>Author:</strong> ${data.blog && data.blog.author ? data.blog.author.first_name + ' ' + data.blog.author.last_name : 'No author'}</p>
                    </div>
                `;
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="result error">
                        <h4>‚ùå GET Blog Detail Failed</h4>
                        <p><strong>Error:</strong> ${error.message}</p>
                    </div>
                `;
            }
        }

        async function testAddBlog() {
            const resultsDiv = document.getElementById('add-blog-results');
            const token = document.getElementById('authToken').value;
            
            if (!token) {
                resultsDiv.innerHTML = `
                    <div class="result error">
                        <h4>‚ùå Authentication Required</h4>
                        <p>Please enter an authentication token to test blog creation.</p>
                    </div>
                `;
                return;
            }
            
            const blogData = {
                title: document.getElementById('blogTitle').value,
                description: document.getElementById('blogDescription').value,
                body: document.getElementById('blogBody').value,
                read_time: document.getElementById('readTime').value,
                tag_list: document.getElementById('tagList').value
            };
            
            resultsDiv.innerHTML = '<p>Testing POST /blogs/add-blog...</p>';
            
            try {
                const response = await fetch(`${API_BASE_URL}/blogs/add-blog`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Token': token
                    },
                    body: JSON.stringify(blogData)
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    resultsDiv.innerHTML = `
                        <div class="result success">
                            <h4>‚úÖ Add Blog Success</h4>
                            <p><strong>Status:</strong> ${response.status}</p>
                            <p><strong>Blog ID:</strong> ${data.blog ? data.blog.id : 'Unknown'}</p>
                            <p><strong>Title:</strong> ${data.blog ? data.blog.title : 'Unknown'}</p>
                            <p><strong>Author:</strong> ${data.blog && data.blog.author ? data.blog.author.first_name + ' ' + data.blog.author.last_name : 'No author'}</p>
                        </div>
                    `;
                } else {
                    resultsDiv.innerHTML = `
                        <div class="result error">
                            <h4>‚ùå Add Blog Failed</h4>
                            <p><strong>Status:</strong> ${response.status}</p>
                            <p><strong>Error:</strong> ${data.message || 'Unknown error'}</p>
                        </div>
                    `;
                }
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="result error">
                        <h4>‚ùå Add Blog Failed</h4>
                        <p><strong>Error:</strong> ${error.message}</p>
                    </div>
                `;
            }
        }

        // Auto-run basic tests when page loads
        window.onload = function() {
            testGetAllBlogs();
        };
    </script>
</body>
</html>
